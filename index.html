<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NanoSorz: Botanical Nanorobotics Simulator</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="ambient">
      <span class="orb orb-1"></span>
      <span class="orb orb-2"></span>
      <span class="orb orb-3"></span>
    </div>
    <header class="site-header">
      <div class="brand">
        <p class="eyebrow">NanoSorz :: 1996 -> 2026</p>
        <h1>Nanorobotics Simulator</h1>
        <p class="tagline">A modernized sandbox inspired by a 1996-era nano-bot swarm.</p>
      </div>
      <div class="header-actions">
        <button class="ghost" type="button" popovertarget="legend-popover">Legend</button>
        <button class="ghost" type="button" id="about-button">About</button>
      </div>
    </header>

    <section class="status-ribbon" aria-label="Session status">
      <div class="chip">Mode: <span id="status-run">Running</span></div>
      <div class="chip">Speed: <span id="status-speed">8Ã—</span></div>
      <div class="chip">Seed: <span id="status-seed">1996</span></div>
    </section>

    <main class="layout">
      <section class="sim-panel" aria-label="Simulation view">
        <div class="canvas-shell">
          <canvas id="sim-canvas" width="720" height="720"></canvas>
          <div class="overlay" aria-hidden="true">
            <div class="overlay-grid"></div>
            <div class="overlay-label">TopScanner</div>
          </div>
        </div>
        <div class="sim-toolbar" role="toolbar" aria-label="Simulation controls">
          <button id="pause-button" type="button">Pause</button>
          <button id="step-button" type="button">Step</button>
          <button id="reset-button" type="button">Reset</button>
        </div>
        <section class="terminal" aria-label="Event log">
          <div class="terminal-header">
            <span>Swarm Event Log</span>
            <span class="terminal-count"><span id="event-count">0</span> events</span>
          </div>
          <ol id="event-log" class="terminal-log"></ol>
        </section>
      </section>

      <aside class="control-panel">
        <form id="controls" class="control-stack">

          <fieldset>
            <legend>Simulation</legend>
            <label>
              Speed
              <input id="speed" type="range" min="1" max="12" value="8" />
            </label>
            <div class="inline-row">
              <span class="hint">Slow</span>
              <span class="hint">Fast</span>
            </div>
            <label class="toggle">
              <input id="strict-collect" type="checkbox" />
              Require deposit proximity
            </label>
          </fieldset>

          <fieldset>
            <legend>Population</legend>
            <label>
              PawnBots
              <input id="pawn-count" type="number" min="0" max="5000" value="1000" />
            </label>
            <label>
              ControlBots
              <input id="control-count" type="number" min="0" max="500" value="10" />
            </label>
            <button id="respawn-button" type="button">Respawn bots</button>
          </fieldset>

          <fieldset>
            <legend>Camera</legend>
            <div class="inline-row">
              <button id="fit-button" type="button">Fit to world</button>
              <button id="center-button" type="button">Center on NanoCore</button>
            </div>
          </fieldset>

          <fieldset>
            <legend>Visuals</legend>
            <label class="toggle">
              <input id="trails-toggle" type="checkbox" checked />
              Motion trails
            </label>
          </fieldset>

          <fieldset>
            <legend>Seed</legend>
            <label>
              Simulation seed
              <input id="seed" type="text" value="1996" />
            </label>
          </fieldset>
        </form>

        <section class="stats" aria-live="polite">
          <h2>Status</h2>
          <dl>
            <div>
              <dt>PawnBots</dt>
              <dd id="stat-pawn">0</dd>
            </div>
            <div>
              <dt>ControlBots</dt>
              <dd id="stat-control">0</dd>
            </div>
            <div>
              <dt>NanoCore cargo</dt>
              <dd id="stat-cargo">0</dd>
            </div>
            <div>
              <dt>NanoCore state</dt>
              <dd id="stat-state">0</dd>
            </div>
            <div>
              <dt>Deposit X</dt>
              <dd id="stat-deposit-x">0</dd>
            </div>
            <div>
              <dt>Deposit Y</dt>
              <dd id="stat-deposit-y">0</dd>
            </div>
            <div>
              <dt>Zoom</dt>
              <dd id="stat-zoom">0</dd>
            </div>
            <div>
              <dt>Speed</dt>
              <dd id="stat-time">8</dd>
            </div>
          </dl>
        </section>

        <details class="help">
          <summary>Controls</summary>
          <ul>
            <li><strong>Space</strong> pause or resume.</li>
            <li>Scroll to zoom, drag to pan.</li>
          </ul>
        </details>
      </aside>
    </main>

    <div id="legend-popover" popover class="popover">
      <h3>Legend</h3>
      <div class="legend-grid">
        <span class="swatch pawn"></span>
        <span>PawnBot</span>
        <span class="swatch control"></span>
        <span>ControlBot</span>
        <span class="swatch nano"></span>
        <span>NanoCore</span>
        <span class="swatch deposit"></span>
        <span>Deposit (current + last)</span>
        <span class="swatch signal"></span>
        <span>ControlBot signal radius</span>
        <span class="swatch resource"></span>
        <span>Resource history glow</span>
      </div>
    </div>

    <dialog id="about-dialog">
      <h2>About NanoSorz</h2>
      <p>
        This is a modernized take on a 1996 nanobot simulator. The physics are still delightfully
        tiny and chaotic, but the UI now uses native HTML controls with minimal JavaScript.
      </p>
      <form method="dialog">
        <button>Close</button>
      </form>
    </dialog>

    <noscript>
      <div class="noscript">
        JavaScript is required to run the simulation. The UI will still render, but the swarm
        will remain paused.
      </div>
    </noscript>

    <script type="module" src="dist/main.js"></script>
  </body>
</html>
